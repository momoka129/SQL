
-- Commands

show databases;

create database testing;

USE testing;

show tables;

-- FIND ALL THE INFO OF CUSTOMERS WHOSE AGE LARGER THAN 20
SELECT *
FROM CUSTOMERS
WHERE AGE > 20;

-- FIND THE AVERAGE AGE OF ALL CUSTOMERS
SELECT AVG(AGE) AS AVERAGE_OF_ALL_CUSTOMERS
FROM CUSTOMERS;

-- FIND THE CUSTOMER'S NAME AND AGE WHOSE THEIR NAME STARTING WITH 'J'
SELECT CUSTOMERS.CNAME
FROM CUSTOMERS
WHERE CNAME LIKE 'J%';

-- WHO BOUGHT THE BOOK NAMED 'BLINDNESS'
SELECT CUSTOMERS.CNAME, BOOKS.TITLE
FROM CUSTOMERS, BOOKS, PURCHASES
WHERE TITLE = 'BLINDNESS'
AND CUSTOMERS.CID = PURCHASES.CID
AND PURCHASES.BOOKID = BOOKS.BOOKID;

SELECT BOOKS.TITLE
FROM BOOKS
WHERE BOOKS.YEAR > 2000;


-- create tables
CREATE TABLE BOOKS(
BOOKID INT,
TITLE varchar(80),
AUTHOR varchar(40),
YEAR integer,
CATEGORY varchar(15),
primary key(BOOKID)
);

CREATE TABLE CUSTOMERS(
CID int primary key,
CNAME char(40),
AGE integer
);

CREATE TABLE PURCHASES(
CID INT,
BOOKID INT,
PDATE DATE,
PPRICE INT,
FOREIGN KEY (BOOKID) REFERENCES BOOKS (BOOKID),
FOREIGN KEY (CID) REFERENCES CUSTOMERS(CID)
);

CREATE TABLE PRICING(
    BOOKID INT,
    FORMAT VARCHAR(15),
    PRICE INT,
    FOREIGN KEY (BOOKID) REFERENCES BOOKS(BOOKID)
);

-- DATA INSERT
-- BOOKS DATA
INSERT INTO BOOKS VALUES
(101,'INTRODUCTION TO DATABASES', 'DAVID MAIER', 1981, 'TEXTBOOK');
INSERT INTO BOOKS VALUES
(102,'DATABASE SYSTEM CONCEPTS','ABRAHAM SILBER',2004,'TEXTBOOK');
INSERT INTO BOOKS VALUES
(103,'PRINCIPLES OF DATABASE AND KNOWLEDGE-BASE SYSTEMS','JEFFREY ULLMAN',1997,'TEXTBOOK');
INSERT INTO BOOKS VALUES
(104,'FIRST COURSE IN DATABASE SYSTEMS','JEFFREY',2008,'TEXTBOOK');
INSERT INTO BOOKS VALUES
(105,'PROMISES TO KEEP: ON LIFE AND POLITICS','JOSEPH',2008,'POLITICS');
INSERT INTO BOOKS VALUES
(106,'CHANGE WE CAN BELIEVE IN: BARACK OBAMAS PLAN TO RENEW AMERICAS','BARACK OBAMA',2008,'POLITICS');
INSERT INTO BOOKS VALUES
(107,'BLINDNESS','JOSE SARAMAGO',1999,'ROMANCE');
INSERT INTO BOOKS VALUES
(108,'THE JESUS CHRIST','JOSE SARAMAGO',1994,'ROMANCE');
INSERT INTO BOOKS VALUES
(109,'SAUCES: CLASSICAL SAUCE MAKING','JAMES PETERSON',2008,'COOKING');

-- CUSTOMER DATA
INSERT INTO CUSTOMERS VALUES (1, 'JOHN', 20);
INSERT INTO CUSTOMERS VALUES (2, 'MARY', 18);
INSERT INTO CUSTOMERS VALUES (3, 'JANE', 28);
INSERT INTO CUSTOMERS VALUES (4, 'ANN', 40);
INSERT INTO CUSTOMERS VALUES (5, 'JOYCE', 33);
INSERT INTO CUSTOMERS VALUES (6, 'TERRY', 25);
INSERT INTO CUSTOMERS VALUES (7, 'CLAIRE', 80);
INSERT INTO CUSTOMERS VALUES (8, 'JOHN', 60);

-- PURCHASE DATA
INSERT INTO PURCHASES VALUES (1, 102, DATE '2004-3-10', 60);
INSERT INTO PURCHASES VALUES (1, 103, DATE '1999-1-10', 40);
INSERT INTO PURCHASES VALUES (1, 104, DATE '2008-8-1', 120);
INSERT INTO PURCHASES VALUES (1, 106, DATE '2008-7-1', 10.00);
INSERT INTO PURCHASES VALUES (1, 107, DATE '2000-11-4', 7.49);
INSERT INTO PURCHASES VALUES (1, 109, DATE '2008-7-1', 32.97);
INSERT INTO PURCHASES VALUES (2, 101, DATE '1999-2-10', 20);
INSERT INTO PURCHASES VALUES (2, 102, DATE '2004-03-04', 60);
INSERT INTO PURCHASES VALUES (3, 103, DATE '1999-1-1', 40);
INSERT INTO PURCHASES VALUES (3, 104, DATE '2008-8-1', 120);
INSERT INTO PURCHASES VALUES (3, 109, DATE '2008-8-2', 32.97);
INSERT INTO PURCHASES VALUES (4, 105, DATE '1999-9-3', 20);
INSERT INTO PURCHASES VALUES (5, 106, DATE '2004-3-1', 60);
INSERT INTO PURCHASES VALUES (6, 107, DATE '2004-7-7', 60);
INSERT INTO PURCHASES VALUES (7, 109, DATE '2008-10-4', 30.45);

-- PRICING DATA
INSERT INTO PRICING VALUES (101,'HARDCOVER', 32.95);
INSERT INTO PRICING VALUES (102,'HARDCOVER', 120.00);
INSERT INTO PRICING VALUES (103,'PAPERBACK', 35.00);
INSERT INTO PRICING VALUES (104,'HARDCOVER', 130.00);
INSERT INTO PRICING VALUES (105,'PAPERBACK', 12.55);
INSERT INTO PRICING VALUES (106,'PAPERBACK', 7.48);
INSERT INTO PRICING VALUES (107,'PAPERBACK', 17.98);
INSERT INTO PRICING VALUES (108,'PAPERBACK', 14.33);
INSERT INTO PRICING VALUES (109,'PAPERBACK', 44.88);